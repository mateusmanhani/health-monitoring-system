<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Fall Detection Monitor</title>
</head>
<body>
<h1>Patient Fall Detection Monitor</h1>

<!-- Patient Selection -->
<div>
    <form action="/falldetection" method="get">
        <select name="patientId" required>
            <option value="">-- Select Patient --</option>
            <option th:each="patient : ${patients}"
                    th:value="${patient.patientId}"
                    th:text="${patient.name + ' ' + patient.surname}"
                    th:selected="${patient.patientId == param.patientId}">
            </option>
        </select>
        <button type="submit">Get Fall Events</button>
    </form>
</div>

<!-- Display Results -->
<div th:if="${latestLog != null}">
    <p>Fall Detected: <span th:text="${latestLog.fallDetected ? 'Yes' : 'No'}"></span></p>
    <p>Recorded at: <span th:text="${latestLog.timestamp}"></span></p>
</div>

<!-- History Table -->
<div th:if="${history != null}">
    <h4>Fall Detection History</h4>
    <table border="1">
        <tr><th>Time</th><th>Fall Detected</th></tr>
        <tr th:each="h : ${history}">
            <td th:text="${h.timestamp}"></td>
            <td th:text="${h.fallDetected ? 'Yes' : 'No'}"></td>
        </tr>
    </table>
</div>

</body>
</html>

