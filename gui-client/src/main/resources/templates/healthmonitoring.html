<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Health Monitoring</title>
</head>
<body>
<h1>Health Monitoring Dashboard</h1>
<form action="/healthmonitoring" method="get">
    <select name="patientId" required>
        <option value="">-- Select Patient --</option>
        <option th:each="patient : ${patients}"
                th:value="${patient.patientId}"
                th:text="${patient.name + ' ' + patient.surname}"
                th:selected="${patient.patientId == param.patientId}">
        </option>
    </select>
    <button type="submit">Show Data</button>
</form>

<div th:if="${latestHeartRate != null}">
    <h2>Heart Rate</h2>
    <p>BPM: <span th:text="${latestHeartRate.bpm}"></span></p>
    <p>Recorded at: <span th:text="${latestHeartRate.timestamp}"></span></p>
    <h4>History</h4>
    <table border="1">
        <tr><th>Time</th><th>BPM</th></tr>
        <tr th:each="h : ${heartRateHistory}">
            <td th:text="${h.timestamp}"></td>
            <td th:text="${h.bpm}"></td>
        </tr>
    </table>
</div>

<div th:if="${latestStepCount != null}">
    <h2>Step Count</h2>
    <p>Steps: <span th:text="${latestStepCount.steps}"></span></p>
    <p>Recorded at: <span th:text="${latestStepCount.timestamp}"></span></p>
    <h4>History</h4>
    <table border="1">
        <tr><th>Time</th><th>Steps</th></tr>
        <tr th:each="h : ${stepCountHistory}">
            <td th:text="${h.timestamp}"></td>
            <td th:text="${h.steps}"></td>
        </tr>
    </table>
</div>

<!-- Fall Detection Alerts -->
<div th:if="${fallAlerts != null && !fallAlerts.isEmpty()}">
    <h2>Fall Detection Alerts</h2>
    <table border="1">
        <tr><th>Time</th><th>Message</th></tr>
        <tr th:each="alert : ${fallAlerts}">
            <td th:text="${alert.timestamp}"></td>
            <td th:text="${alert.message}"></td>
        </tr>
    </table>
</div>

</body>
</html>
